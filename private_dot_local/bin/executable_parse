#!/bin/python3
import json
import threading
from http.server import BaseHTTPRequestHandler, HTTPServer


class TestCaseHandler(BaseHTTPRequestHandler):
  def do_POST(self):
    post_data = self.rfile.read()
    json_data = json.loads(post_data)
    for i, test in enumerate(json_data["tests"], start=1):
      with open("in" + str(i), mode="w") as f:
        f.write(test["input"])
      with open("ans" + str(i), mode="w") as f:
        f.write(test["output"])
    print(f"已生成 {len(json_data['tests'])} 个测试点")
    threading.Thread(target=self.server.shutdown, daemon=True).start()


port = 10045
server_address = ("localhost", port)
httpd = HTTPServer(server_address, TestCaseHandler)
httpd.serve_forever()